<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>VitaSenseAI Health Risk Prediction</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1>VitaSenseAI</h1>
        <p class="subtitle">Predict your health risk!</p>
        <form id="healthForm">
            <div class="form-row">
                <label>Age: <input type="number" name="age" required></label>
                <label>Weight (kg): <input type="number" name="weight" required></label>
                <label>Height (cm): <input type="number" name="height" required></label>
            </div>

            <div class="form-row">
                <label>Exercise:
                    <select name="exercise">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                </label>

                <label>Sleep hours: <input type="number" name="sleep" step="0.1" required></label>

                <label>Sugar Intake:
                    <select name="sugar_intake">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                </label>
            </div>

            <div class="form-row">
                <label>Smoking:
                    <select name="smoking">
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                    </select>
                </label>

                <label>Alcohol:
                    <select name="alcohol">
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                    </select>
                </label>

                <label>Married:
                    <select name="married">
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                    </select>
                </label>

                <label>Profession:
                    <select name="profession">
                        <option value="office_worker">Office Worker</option>
                        <option value="teacher">Teacher</option>
                        <option value="artist">Artist</option>
                        <option value="engineer">Engineer</option>
                        <option value="healthcare">Healthcare</option>
                    </select>
                </label>
            </div>

            <button type="submit">Predict</button>
        </form>

        <div id="result" class="result-card"></div>
    </div>

    <script>
        const form = document.getElementById("healthForm");
        form.addEventListener("submit", async (e) => {
            e.preventDefault();

            const formData = new FormData(form);
            const data = {};
            formData.forEach((value, key) => { data[key] = isNaN(value) ? value : Number(value); });

            try {
                const response = await fetch("/predict", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                if(result.error){
                    document.getElementById("result").innerHTML = `<p class="error">${result.error}</p>`;
                } else {
                    document.getElementById("result").innerHTML = `
                        <p><strong>ML Prediction:</strong> ${result.ml_prediction}</p>
                        <p><strong>Final Risk:</strong> ${result.final_risk}</p>
                        <p><strong>Explanation:</strong> ${result.explanation.join(", ")}</p>
                    `;
                }
            } catch (err) {
                document.getElementById("result").innerHTML = `<p class="error">Error: ${err}</p>`;
            }
        });
    </script>
</body>
</html>
